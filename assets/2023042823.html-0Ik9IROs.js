const t=JSON.parse('{"key":"v-f0073fc6","path":"/article/2023042823.html","title":"记一个 SpringBoot 优雅停机失败问题","lang":"zh-CN","frontmatter":{"title":"记一个 SpringBoot 优雅停机失败问题","icon":"creative","date":"2023-04-28T23:33:52.000Z","category":["文章"],"tag":["Java","SpringBoot"],"star":true,"description":"​ 概要 最近，生产环境 EKS（Elastic Kubernetes Service）偶尔出现 POD 被强杀问题。 项目是 SpringBoot 框架，启动了优雅停机，并且配置了停机时长为 120 秒。既然是被强杀，那肯定是因为在 120 秒内没有正常停掉应用。 经过日志分析，是由于开了弹性伸缩，项目还没启动完就收到了 kill 信号，这时候启动线程和停机线程并行跑，导致被停掉的线程又被启动起来，最终导致优雅停机失败，过了 120 秒后，容器被 kill -9 了。 过程分析 为什么说“启动线程和停机线程并行跑，导致被停掉的线程又被启动起来”，难道 SpringBoot 就这么 LOW ，就不知道让启动线程跑完再执行停机线程？","head":[["link",{"rel":"alternate","hreflang":"en-us","href":"https://blog.chcbz.net/en/article/2023042823.html"}],["meta",{"property":"og:url","content":"https://blog.chcbz.net/article/2023042823.html"}],["meta",{"property":"og:site_name","content":"布衣云水客"}],["meta",{"property":"og:title","content":"记一个 SpringBoot 优雅停机失败问题"}],["meta",{"property":"og:description","content":"​ 概要 最近，生产环境 EKS（Elastic Kubernetes Service）偶尔出现 POD 被强杀问题。 项目是 SpringBoot 框架，启动了优雅停机，并且配置了停机时长为 120 秒。既然是被强杀，那肯定是因为在 120 秒内没有正常停掉应用。 经过日志分析，是由于开了弹性伸缩，项目还没启动完就收到了 kill 信号，这时候启动线程和停机线程并行跑，导致被停掉的线程又被启动起来，最终导致优雅停机失败，过了 120 秒后，容器被 kill -9 了。 过程分析 为什么说“启动线程和停机线程并行跑，导致被停掉的线程又被启动起来”，难道 SpringBoot 就这么 LOW ，就不知道让启动线程跑完再执行停机线程？"}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:locale:alternate","content":"en-US"}],["meta",{"property":"og:updated_time","content":"2023-05-07T03:29:14.000Z"}],["meta",{"property":"article:author","content":"Mr.Chen"}],["meta",{"property":"article:tag","content":"Java"}],["meta",{"property":"article:tag","content":"SpringBoot"}],["meta",{"property":"article:published_time","content":"2023-04-28T23:33:52.000Z"}],["meta",{"property":"article:modified_time","content":"2023-05-07T03:29:14.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"记一个 SpringBoot 优雅停机失败问题\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-04-28T23:33:52.000Z\\",\\"dateModified\\":\\"2023-05-07T03:29:14.000Z\\",\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"Mr.Chen\\",\\"url\\":\\"https://blog.chcbz.net\\"}]}"]]},"headers":[{"level":2,"title":"概要","slug":"概要","link":"#概要","children":[]},{"level":2,"title":"过程分析","slug":"过程分析","link":"#过程分析","children":[]}],"git":{"createdTime":1683430154000,"updatedTime":1683430154000,"contributors":[{"name":"chcbz","email":"chcbz@sina.com","commits":1}]},"readingTime":{"minutes":3.13,"words":940},"filePathRelative":"article/2023042823.md","localizedDate":"2023年4月28日","excerpt":"<p>​</p>\\n<h2> 概要</h2>\\n<p>最近，生产环境 EKS（Elastic Kubernetes Service）偶尔出现 POD 被强杀问题。</p>\\n<p>项目是 SpringBoot 框架，启动了优雅停机，并且配置了停机时长为 120 秒。既然是被强杀，那肯定是因为在 120 秒内没有正常停掉应用。</p>\\n<p>经过日志分析，是由于开了弹性伸缩，项目还没启动完就收到了 kill 信号，这时候启动线程和停机线程并行跑，导致被停掉的线程又被启动起来，最终导致优雅停机失败，过了 120 秒后，容器被 kill -9 了。</p>\\n<h2> 过程分析</h2>\\n<p>为什么说“启动线程和停机线程并行跑，导致被停掉的线程又被启动起来”，难道 SpringBoot 就这么 LOW ，就不知道让启动线程跑完再执行停机线程？</p>","autoDesc":true}');export{t as data};
